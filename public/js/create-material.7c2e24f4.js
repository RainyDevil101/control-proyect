"use strict";(self["webpackChunkbackend"]=self["webpackChunkbackend"]||[]).push([[499],{6267:function(e,a,t){t.d(a,{Z:function(){return m}});var n=t(3396);const r=e=>((0,n.dD)("data-v-3b6b4a29"),e=e(),(0,n.Cn)(),e),o={class:"loader-rev"},i=r((()=>(0,n._)("div",null,null,-1))),l=[i];function s(e,a,t,r,i,s){return(0,n.wg)(),(0,n.iD)("div",o,l)}var u={},d=t(89);const c=(0,d.Z)(u,[["render",s],["__scopeId","data-v-3b6b4a29"]]);var m=c},847:function(e,a,t){t.r(a),t.d(a,{default:function(){return Y}});var n=t(3396),r=t(9242),o=t(2268);const i=e=>((0,n.dD)("data-v-43b49082"),e=e(),(0,n.Cn)(),e),l={key:1,class:"wrapper"},s={class:"material-form"},u=i((()=>(0,n._)("div",{class:"header-form"},[(0,n._)("h1",null,"Registro")],-1))),d={class:"body body-form"},c={class:"item-form"},m=i((()=>(0,n._)("p",null,"N° de transporte",-1))),p={class:"item-form"},v=i((()=>(0,n._)("p",null,"Código",-1))),g={class:"item-form"},_=i((()=>(0,n._)("p",null,"Cantidad",-1))),f={class:"item-form"},b=i((()=>(0,n._)("p",null,"Cantidad de bultos",-1))),w={class:"item-form"},y=i((()=>(0,n._)("p",null,"Destino",-1))),I=["value"],D={class:"item-form image-form"},h=i((()=>(0,n._)("div",{class:"image-label"},[(0,n._)("label",{for:"imageOne"},"Seleccione la imagen")],-1))),O={key:0,class:"confirmation"},k=i((()=>(0,n._)("div",{class:"submit-button"},[(0,n._)("button",{class:"btn btn-warning",type:"submit"},"Registrar")],-1)));function F(e,a,t,i,F,C){const H=(0,n.up)("loader");return"CARGANDO"===i.status?((0,n.wg)(),(0,n.j4)(H,{key:0,class:"loader-wrapper"})):((0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("div",s,[u,(0,n._)("div",d,[(0,n._)("form",{onSubmit:a[6]||(a[6]=(0,r.iM)(((...e)=>i.onSubmit&&i.onSubmit(...e)),["prevent"]))},[(0,n._)("div",c,[m,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>i.materialForm.transport_number=e),type:"text",maxlength:"45"},null,512),[[r.nr,i.materialForm.transport_number]])]),(0,n._)("div",p,[v,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>i.materialForm.code=e),type:"text",maxlength:"45"},null,512),[[r.nr,i.materialForm.code]])]),(0,n._)("div",g,[_,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>i.materialForm.cantidad=e),type:"number"},null,512),[[r.nr,i.materialForm.cantidad]])]),(0,n._)("div",f,[b,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>i.materialForm.cantidad_bultos=e),type:"number"},null,512),[[r.nr,i.materialForm.cantidad_bultos]])]),(0,n._)("div",w,[y,(0,n.wy)((0,n._)("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>i.materialForm.destination=e)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.destinations,(e=>((0,n.wg)(),(0,n.iD)("option",{key:e.nombre,value:e.id},(0,o.zw)(e.nombre),9,I)))),128))],512),[[r.bM,i.materialForm.destination]])]),(0,n._)("div",D,[(0,n._)("input",{type:"file",onChange:a[5]||(a[5]=(...e)=>i.onImageOne&&i.onImageOne(...e)),id:"imageOne",accept:"image/png, image/jpg, image/ jpeg"},null,32),h,i.localImageOne?((0,n.wg)(),(0,n.iD)("div",O,[(0,n._)("p",null,(0,o.zw)(i.imgOneName),1)])):(0,n.kq)("",!0)]),k],32)])])]))}var C=t(4870),H=t(2492),x=t.n(H),S=t(6267),R=t(6322);const E=()=>{const e=(0,C.iH)(null),a=(0,C.iH)("CARGANDO"),t=(0,C.iH)("CARGANDO"),n=async()=>{const{data:n}=await R.Z.get("/api/destination ",{headers:{"x-token":localStorage.getItem("token")}}),r=[],o=n.destinations;for(const e of o)r.push(e);return e.value=r,a.value="RECIBIDO",t.value="RECIBIDO",{destinations:e,ok:!0}};return n(),{destinations:e,searchDestinations:n,status:a,secondStatus:t}};var A=E,Z=t(6265),N=t.n(Z);const U=async e=>{if(e)try{const a=new FormData;a.append("upload_preset","tzfir0d9"),a.append("file",e);const{data:t}=await N().post("https://api.cloudinary.com/v1_1/dt4zmocge/image/upload",a);return t.secure_url}catch(a){return console.error("Error al cargar el archivo"),console.log(a),null}};var V=U;const z=()=>{const e=(0,C.iH)(!0),a=(0,C.iH)(null),t=(0,C.iH)(!1),n=async(n,r,o,i)=>{if(console.log(i),!o)return e.value="Error usuario logeado",{errors:e,nice:t,materialId:a};if(""===n.transport_number||""===n.code||""===n.cantidad||""===n.cantidad_bultos||""===n.destination)return e.value="Debe llenar los campos",{errors:e,materialId:a,nice:t};try{const l=await R.Z.post("/api/material",{materialForm:n,imgOne:r,userDivision:o,id:i},{headers:{"x-token":localStorage.getItem("token")}});return a.value=l.data.id,t.value=!0,e.value=!1,{errors:e,nice:t,materialId:a}}catch(l){if(l.response.data.msg)return e.value=l.response.data.msg,a.value=null,t.value=!1,{errors:e,nice:t,materialId:a};if(l.response.data.errors){const n=[],r=l.response.data.errors;for(const e of r)n.push(" "+e.msg);return e.value=n,a.value=null,t.value=!1,{errors:e,nice:t,materialId:a}}return a.value=resp.data.id,e.value=!1,t.value=!0,{errors:e,nice:t,materialId:a}}};return{errors:e,sendForum:n,materialId:a,nice:t}};var G=z,j=t(4207),B={components:{Loader:S.Z},setup(){const e=(0,C.iH)(),a=(0,C.iH)(),t=(0,C.iH)(null),r=(0,C.iH)({transport_number:"",code:"",cantidad:"",cantidad_bultos:"",destination:""}),{userDivision:o,userId:i}=(0,j.Z)(),{destinations:l,searchDestinations:s,status:u,secondStatus:d}=A(),{sendForum:c}=G(),{uploadImageOne:m}=V();return(0,n.YP)((()=>e.value),(()=>t.value=e.value)),{localImageOne:e,imgOneName:a,imgOne:t,destinations:l,searchDestinations:s,status:u,secondStatus:d,materialForm:r,uploadImageOne:m,sendForum:c,userId:i,onSubmit:async()=>{new(x())({title:"Espere por favor",allowOutsideClick:!1}),x().showLoading();const e=r.value;if(""===e.transport_number||""===e.code||""===e.cantidad||""===e.cantidad_bultos||""===e.destination)return x().fire({title:"Error",text:"Debe completar los campos",icon:"error"});if(null===t.value)return x().fire({title:"Error",text:"Debe seleccionar la imagen",icon:"error"});const a=await V(t.value),{errors:n,nice:l,materialId:s}=await c(r.value,a,o.value,i.value);!1===l.value?x().fire({title:"Error",text:`${n.value}`,icon:"error"}):x().fire("Guardado",`Bulto ${s.value} registrado con éxito`,"success").then((function(e){location.reload()}))},onImageOne:async t=>{const n=t.target.files[0];if(!n)return e.value=null,void(a.value=null);{a.value=n.name;const t=new FileReader;t.onload=()=>e.value=t.result,t.readAsDataURL(n)}}}}},L=t(89);const M=(0,L.Z)(B,[["render",F],["__scopeId","data-v-43b49082"]]);var Y=M}}]);
//# sourceMappingURL=create-material.7c2e24f4.js.map