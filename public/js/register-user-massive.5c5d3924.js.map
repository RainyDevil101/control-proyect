{"version":3,"file":"js/register-user-massive.5c5d3924.js","mappings":"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","sources":["webpack://backend/./src/modules/register/views/UserMassiveRegistation.vue","webpack://backend/./src/modules/register/composables/uploadExcelUsers.js","webpack://backend/./src/modules/register/composables/createUserTemplate.js","webpack://backend/./src/modules/register/views/UserMassiveRegistation.vue?aebe"],"sourcesContent":["<template>\r\n  <div class=\"wrapper\">\r\n    <div class=\"container-massive\">\r\n      <div class=\"massive-header\">\r\n        <h1>Carga de usuarios</h1>\r\n      </div>\r\n\r\n      <div class=\"instructions\">\r\n        <p>\r\n          Descargue la plantilla Excel que encontrará abajo e ingrese los datos\r\n          en el formato que aparece ahí, para que los datos sean cargados\r\n          correctamente tenga en cuenta lo siguiente:\r\n        </p>\r\n        <hr />\r\n        <ul>\r\n          <li>Los nombres y apellidos deben ir en sus respectivas celdas.</li>\r\n          <li>Los usuarios deben tener un email válido.</li>\r\n          <li>\r\n            Debe ingresar el rut con alguno de los siguientes formatos:\r\n            <ul>\r\n              <li>12.345.678-9</li>\r\n              <li>123456789</li>\r\n              <li>12*345*678*9</li>\r\n              <li>12345678-9</li>\r\n            </ul>\r\n          </li>\r\n          <li>\r\n            <p>Las divisiones deben escribirse de la siguiente manera:</p>\r\n            <ul>\r\n              <li>TENIENTE</li>\r\n              <li>ANDINA</li>\r\n              <li>VENTANAS</li>\r\n              <li>SALVADOR</li>\r\n              <li>CHUQUICAMATA</li>\r\n              <li>ESPORADICOS ANDINA</li>\r\n              <li>ESPORADICOS TENIENTE</li>\r\n              <li>CASA MATRIZ</li>\r\n            </ul>\r\n          </li>\r\n          <li>\r\n            <p>El cargo debe ser uno de los siguientes:</p>\r\n            <ul>\r\n              <li>PLANIFICADOR</li>\r\n              <li>OPERADOR LOGISTICO</li>\r\n            </ul>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n\r\n      <div class=\"form-massive\">\r\n        <form @submit.prevent=\"onSubmit\">\r\n          <div class=\"input-button\">\r\n            <input\r\n              type=\"file\"\r\n              @change=\"onFile\"\r\n              id=\"excel-file\"\r\n              accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"\r\n            />\r\n            <div class=\"button-align download-plantilla\">\r\n              <button @click=\"onDownload\" type=\"button\" class=\"buttons-styles\">\r\n                Descargar plantilla\r\n              </button>\r\n            </div>\r\n            <div class=\"button-align select-file\">\r\n              <label class=\"buttons-styles\" for=\"excel-file\"\r\n                >Seleccionar archivo</label\r\n              >\r\n            </div>\r\n            <div class=\"button-align load-file-button\">\r\n              <button type=\"submit\" class=\"buttons-styles\" value=\"Store File\">\r\n                Cargar\r\n              </button>\r\n            </div>\r\n            <div class=\"button-align back-button\">\r\n              <button\r\n                type=\"button\"\r\n                @click=\"$router.push({ name: 'select-register' })\"\r\n                class=\"buttons-styles\"\r\n              >\r\n                Volver\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref } from \"@vue/reactivity\";\r\nimport { useStore } from \"vuex\";\r\nimport uploadUsers from \"../composables/uploadExcelUsers\";\r\nimport createFiles from \"../composables/createUserTemplate\";\r\nimport Swal from \"sweetalert2\";\r\nexport default {\r\n  setup() {\r\n    const store = useStore();\r\n    const localFile = ref(null);\r\n\r\n    const { sendData } = uploadUsers();\r\n    const { excelTemplateUsers } = createFiles();\r\n\r\n    return {\r\n      localFile,\r\n      sendData,\r\n      excelTemplateUsers,\r\n\r\n      onSubmit: async () => {\r\n        new Swal({\r\n          title: \"Espere por favor\",\r\n          allowOutsideClick: false,\r\n        });\r\n        Swal.showLoading();\r\n\r\n        const { errors, nice, message } = await sendData(localFile.value);\r\n\r\n        if (nice.value === false) {\r\n          Swal.fire(\"Error\", `${errors.value}.`, \"error\").then(function (\r\n            result\r\n          ) {\r\n            if (true) {\r\n              location.reload();\r\n            }\r\n          });\r\n          return;\r\n        } else {\r\n          await store.dispatch(\"users/loadUsers\");\r\n\r\n          Swal.fire(\"Guardado\", `${message.value}`, \"success\").then(function (\r\n            result\r\n          ) {\r\n            if (true) {\r\n              location.reload();\r\n            }\r\n          });\r\n        }\r\n      },\r\n      onFile: async (event) => {\r\n        const file = event.target.files[0];\r\n        if (!file) {\r\n          localFile.value = null;\r\n          return;\r\n        } else {\r\n          localFile.value = file;\r\n        }\r\n      },\r\n      onDownload: async () => {\r\n\r\n        const { ok } = excelTemplateUsers();\r\n\r\n        console.log(ok);\r\n\r\n      },\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\nh1 {\r\n  margin: 8px 0 8px 0;\r\n}\r\n\r\np {\r\n  margin: 8px 0 8px 0;\r\n}\r\n.wrapper {\r\n  padding-top: 4rem;\r\n  min-height: 100vh;\r\n  min-width: 100vw;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.container-massive {\r\n  background-color: white;\r\n  border-radius: 4px;\r\n  margin: 4px;\r\n  border: 1px solid rgba($color: rgb(0, 65, 127), $alpha: 1);\r\n}\r\n\r\n.form-massive {\r\n  padding: 1rem;\r\n}\r\n\r\n.input-button {\r\n  display: block;\r\n  margin: auto;\r\n}\r\n\r\n.button-align {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin: 4px 0 4px 0;\r\n}\r\n\r\n.buttons-styles {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background-color: rgba($color: rgb(0, 65, 127), $alpha: 1);\r\n  border-radius: 4px;\r\n  color: white;\r\n  padding: 8px;\r\n  width: 9.8rem;\r\n  height: 44px;\r\n  border: none;\r\n  cursor: default;\r\n    transition: 0.2s;\r\n\r\n  &:hover {\r\n    background-color: rgba($color: #444444, $alpha: 1.0);\r\n  }\r\n\r\n}\r\n\r\ninput[type=\"file\"] {\r\n  display: none;\r\n}\r\n\r\n.download-file {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin: 4px 0 4px 0;\r\n}\r\n\r\n.instructions {\r\n  max-width: 680px;\r\n}\r\n\r\n.massive-header {\r\n  text-align: center;\r\n  margin: 4px 0 4px 0;\r\n}\r\n\r\n@media screen and(min-width: 720px) {\r\n  .input-button {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n  }\r\n\r\n  .container-massive {\r\n  padding: 1rem;\r\n}\r\n\r\n}\r\n</style>","import { ref } from \"vue\";\r\nimport backendConnect from \"../../../api/backend\";\r\n\r\nconst uploadUsers = () => {\r\n  const errors = ref(true);\r\n  const nice = ref(null);\r\n  const message = ref(null);\r\n\r\n  const sendData = async (excelFile) => {\r\n    if (!excelFile) {\r\n        errors.value = 'Debe seleccionar un archivo';\r\n        nice.value = false;\r\n        return { errors, nice };\r\n    };\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", excelFile);\r\n\r\n      const { data } = await backendConnect.post(\r\n        \"/api/userExcel/uploadFile\",\r\n        formData,\r\n        {\r\n          headers: { \"x-token\": localStorage.getItem(\"token\") },\r\n        }\r\n      );\r\n\r\n      console.log(data);\r\n\r\n      nice.value = true;\r\n      errors.value = false;\r\n      message.value = data.msg;\r\n\r\n      return { errors, nice, message };\r\n    } catch (error) {\r\n      if (error.response.data.msg) {\r\n        errors.value = error.response.data.msg\r\n        nice.value = false;\r\n        console.log(errors.value);\r\n        return { errors, nice, message };\r\n      } else if (error.response.data.errors) {\r\n        const msgErr = [];\r\n        const errorsDb = error.response.data.errors;\r\n        for (const error of errorsDb) {\r\n          msgErr.push(\" \" + error.msg);\r\n        }\r\n        errors.value = msgErr;\r\n        nice.value = false;\r\n        return { errors, nice, message };\r\n      } else {\r\n        errors.value = true;\r\n        nice.value = false;\r\n        return { errors, nice, message };\r\n      }\r\n    }\r\n  };\r\n\r\n  return {\r\n    errors,\r\n    sendData,\r\n    nice,\r\n    message,\r\n  };\r\n};\r\n\r\nexport default uploadUsers;\r\n","import { ref } from \"vue\";\r\nimport { read, utils, writeFile } from \"xlsx\";\r\n\r\nconst createFiles = () => {\r\n  const ok = ref(false);\r\n\r\n  const excelTemplateUsers = () => {\r\n    let workbook = utils.book_new();\r\n\r\n    let name = \"USUARIOS\";\r\n\r\n    let ExampleDataToUseInExcel = [\r\n      {\r\n        NOMBRES: \"OSCAR ROLANDO\",\r\n        APELLIDOS: \"PALACIOS SERRAT\",\r\n        EMAIL: \"PENDIENTE\",\r\n        RUT: \"13674111-k\",\r\n        DIVISION: \"ANDINA\",\r\n        CARGO: \"OPERADOR LOGISTICO\",\r\n      },\r\n      {\r\n        NOMBRES: \"PABLO EMILIO\",\r\n        APELLIDOS: \"YAEGER LATORRE\",\r\n        EMAIL: \"PENDIENTE\",\r\n        RUT: \"17971650-k\",\r\n        DIVISION: \"ANDINA\",\r\n        CARGO: \"OPERADOR LOGISTICO\",\r\n      },\r\n      {\r\n        NOMBRES: \"JUAN MANUEL\",\r\n        APELLIDOS: \"AGUILERA PORRAS\",\r\n        EMAIL: \"PENDIENTE\",\r\n        RUT: \"11517358-8\",\r\n        DIVISION: \"ANDINA\",\r\n        CARGO: \"OPERADOR LOGISTICO\",\r\n      },\r\n    ];\r\n\r\n    let objectMaxLength = [];\r\n\r\n    for (let i = 0; i < ExampleDataToUseInExcel.length; i++) {\r\n      let value = Object.values(ExampleDataToUseInExcel[i]);\r\n      for (let j = 0; j < value.length; j++) {\r\n        if (typeof value[j] == \"number\") {\r\n          objectMaxLength[j] = 10;\r\n        } else {\r\n          objectMaxLength[j] =\r\n            objectMaxLength[j] >= value[j].length\r\n              ? objectMaxLength[j]\r\n              : value[j].length;\r\n        }\r\n      }\r\n    }\r\n\r\n    const wscols = objectMaxLength.map((w) => {\r\n      return { width: w };\r\n    });\r\n\r\n    let worksheet = utils.json_to_sheet(ExampleDataToUseInExcel);\r\n\r\n    worksheet[\"!cols\"] = wscols;\r\n\r\n    utils.book_append_sheet(workbook, worksheet, name);\r\n\r\n    let fileName = \"plantilla_carga_usuarios.xlsx\";\r\n\r\n    writeFile(workbook, fileName);\r\n\r\n    ok.value = true;\r\n\r\n    return { ok };\r\n  };\r\n\r\n  return {\r\n    excelTemplateUsers,\r\n    ok,\r\n  };\r\n};\r\n\r\nexport default createFiles;\r\n","import { render } from \"./UserMassiveRegistation.vue?vue&type=template&id=4406d5e0&scoped=true\"\nimport script from \"./UserMassiveRegistation.vue?vue&type=script&lang=js\"\nexport * from \"./UserMassiveRegistation.vue?vue&type=script&lang=js\"\n\nimport \"./UserMassiveRegistation.vue?vue&type=style&index=0&id=4406d5e0&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\Gorilla Setups\\\\Desktop\\\\control-proyect\\\\frontend\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4406d5e0\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","for","type","value","_createElementBlock","_hoisted_3","onSubmit","$setup","onChange","id","accept","onClick","_hoisted_8","_hoisted_9","_ctx","push","name","uploadUsers","errors","ref","nice","message","sendData","async","excelFile","formData","FormData","append","data","backendConnect","headers","localStorage","getItem","console","log","msg","error","response","msgErr","errorsDb","createFiles","ok","excelTemplateUsers","workbook","utils","ExampleDataToUseInExcel","NOMBRES","APELLIDOS","EMAIL","RUT","DIVISION","CARGO","objectMaxLength","i","length","Object","values","j","wscols","map","w","width","worksheet","fileName","writeFile","setup","store","useStore","localFile","Swal","title","allowOutsideClick","dispatch","then","result","location","reload","onFile","file","event","target","files","onDownload","__exports__","render"],"sourceRoot":""}