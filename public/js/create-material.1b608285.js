"use strict";(self["webpackChunkbackend"]=self["webpackChunkbackend"]||[]).push([[499],{6267:function(e,a,t){t.d(a,{Z:function(){return m}});var n=t(3396);const r=e=>((0,n.dD)("data-v-3b6b4a29"),e=e(),(0,n.Cn)(),e),o={class:"loader-rev"},i=r((()=>(0,n._)("div",null,null,-1))),l=[i];function s(e,a,t,r,i,s){return(0,n.wg)(),(0,n.iD)("div",o,l)}var u={},d=t(89);const c=(0,d.Z)(u,[["render",s],["__scopeId","data-v-3b6b4a29"]]);var m=c},7517:function(e,a,t){t.r(a),t.d(a,{default:function(){return K}});var n=t(3396),r=t(9242),o=t(2268);const i=e=>((0,n.dD)("data-v-7f151f08"),e=e(),(0,n.Cn)(),e),l={key:1,class:"wrapper"},s={class:"material-form"},u=i((()=>(0,n._)("div",{class:"header-form"},[(0,n._)("h1",null,"Registro")],-1))),d={class:"body body-form"},c={class:"item-form"},m=i((()=>(0,n._)("p",null,"Ingrese N° de transporte",-1))),p={class:"item-form"},v=i((()=>(0,n._)("p",null,"Código de material",-1))),g={class:"item-form"},f=i((()=>(0,n._)("p",null,"Cantidad",-1))),_={class:"item-form"},b=i((()=>(0,n._)("p",null,"Cantidad de bultos",-1))),y={class:"item-form"},w=i((()=>(0,n._)("p",null,"Destino",-1))),I=["value"],h={class:"item-form"},D=i((()=>(0,n._)("p",null,"UBICACIÓN",-1))),F={class:"item-form image-form"},O=i((()=>(0,n._)("div",{class:"image-label"},[(0,n._)("label",{for:"imageOne"},"Seleccione la imagen")],-1))),k={key:0,class:"confirmation"},C={class:"submit-button"},x=i((()=>(0,n._)("button",{class:"buttons-styles",type:"submit"},"Finalizar",-1)));function H(e,a,t,i,H,S){const A=(0,n.up)("loader");return"CARGANDO"===i.status?((0,n.wg)(),(0,n.j4)(A,{key:0,class:"loader-wrapper"})):((0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("div",s,[u,(0,n._)("div",d,[(0,n._)("form",{onSubmit:a[8]||(a[8]=(0,r.iM)(((...e)=>i.onSubmit&&i.onSubmit(...e)),["prevent"]))},[(0,n._)("div",c,[m,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>i.materialForm.transport_number=e),type:"text",maxlength:"45"},null,512),[[r.nr,i.materialForm.transport_number]])]),(0,n._)("div",p,[v,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>i.materialForm.code=e),type:"text",maxlength:"45"},null,512),[[r.nr,i.materialForm.code]])]),(0,n._)("div",g,[f,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>i.materialForm.cantidad=e),type:"number"},null,512),[[r.nr,i.materialForm.cantidad]])]),(0,n._)("div",_,[b,(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>i.materialForm.cantidad_bultos=e),type:"number"},null,512),[[r.nr,i.materialForm.cantidad_bultos]])]),(0,n._)("div",y,[w,(0,n.wy)((0,n._)("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>i.materialForm.destination=e)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.destinations,(e=>((0,n.wg)(),(0,n.iD)("option",{key:e.nombre,value:e},(0,o.zw)(e.nombre),9,I)))),128))],512),[[r.bM,i.materialForm.destination]])]),(0,n._)("div",h,[D,(0,n.wy)((0,n._)("textarea",{"onUpdate:modelValue":a[5]||(a[5]=e=>i.materialForm.ubication=e),maxlength:"60"},null,512),[[r.nr,i.materialForm.ubication]])]),(0,n._)("div",F,[(0,n._)("input",{type:"file",onChange:a[6]||(a[6]=(...e)=>i.onImageOne&&i.onImageOne(...e)),id:"imageOne",accept:"image/png, image/jpg, image/ jpeg"},null,32),O,i.localImageOne?((0,n.wg)(),(0,n.iD)("div",k,[(0,n._)("p",null,(0,o.zw)(i.imgOneName),1)])):(0,n.kq)("",!0)]),(0,n._)("div",C,[x,(0,n._)("button",{type:"button",onClick:a[7]||(a[7]=a=>e.$router.push({name:"menu-materials"})),class:"buttons-styles"}," Volver ")])],32)])])]))}var S=t(4870),A=t(2492),E=t.n(A),R=t(6267),U=t(6322);const N=()=>{const e=(0,S.iH)(null),a=(0,S.iH)("CARGANDO"),t=(0,S.iH)("CARGANDO"),n=async()=>{const{data:n}=await U.Z.get("/api/destination ",{headers:{"x-token":localStorage.getItem("token")}}),r=[],o=n.destinations;for(const e of o)r.push(e);return e.value=r,a.value="RECIBIDO",t.value="RECIBIDO",{destinations:e,ok:!0}};return n(),{destinations:e,searchDestinations:n,status:a,secondStatus:t}};var V=N,Z=t(6265),z=t.n(Z);const B=async e=>{if(e)try{const a=new FormData;a.append("upload_preset","tzfir0d9"),a.append("file",e);const{data:t}=await z().post("https://api.cloudinary.com/v1_1/dt4zmocge/image/upload",a);return t.secure_url}catch(a){return console.error("Error al cargar el archivo"),console.log(a),null}};var G=B;const j=()=>{const e=(0,S.iH)(!0),a=(0,S.iH)(null),t=(0,S.iH)(!1),n=async(n,r,o,i)=>{if(!o)return e.value="Error usuario logeado",{errors:e,nice:t,materialId:a};if(""===n.transport_number||""===n.code||""===n.cantidad||""===n.cantidad_bultos||""===n.destination||""===n.ubication)return e.value="Debe llenar los campos",{errors:e,materialId:a,nice:t};try{const l=await U.Z.post("/api/material",{materialForm:n,imgOne:r,userDivision:o,id:i},{headers:{"x-token":localStorage.getItem("token")}});return console.log(l),a.value=l.data.id,t.value=!0,e.value=!1,{errors:e,nice:t,materialId:a}}catch(l){if(console.log(l),l.response.data.msg)return e.value=l.response.data.msg,a.value=null,t.value=!1,{errors:e,nice:t,materialId:a};if(l.response.data.errors){const n=[],r=l.response.data.errors;for(const e of r)n.push(" "+e.msg);return e.value=n,a.value=null,t.value=!1,{errors:e,nice:t,materialId:a}}return a.value=resp.data.id,e.value=!1,t.value=!0,{errors:e,nice:t,materialId:a}}};return{errors:e,sendForum:n,materialId:a,nice:t}};var L=j,$=t(4207),M={components:{Loader:R.Z},setup(){const e=(0,S.iH)(),a=(0,S.iH)(),t=(0,S.iH)(null),r=(0,S.iH)({transport_number:"",code:"",cantidad:"",cantidad_bultos:"",destination:"",ubication:""}),{userDivision:o,userId:i}=(0,$.Z)(),{destinations:l,searchDestinations:s,status:u,secondStatus:d}=V(),{sendForum:c}=L(),{uploadImageOne:m}=G();return(0,n.YP)((()=>e.value),(()=>t.value=e.value)),{localImageOne:e,imgOneName:a,imgOne:t,destinations:l,searchDestinations:s,status:u,secondStatus:d,materialForm:r,uploadImageOne:m,sendForum:c,userId:i,onSubmit:async()=>{new(E())({title:"Espere por favor",allowOutsideClick:!1}),E().showLoading();const e=r.value;if(""===e.transport_number||""===e.code||""===e.cantidad||""===e.cantidad_bultos||""===e.destination)return E().fire({title:"Error",text:"Debe completar los campos",icon:"error"});if(null===t.value)return E().fire({title:"Error",text:"Debe seleccionar la imagen",icon:"error"});const a=await G(t.value),{errors:n,nice:l,materialId:s}=await c(r.value,a,o.value,i.value);!1===l.value?E().fire({title:"Error",text:`${n.value}`,icon:"error"}):E().fire("Guardado",`Bulto ${s.value} registrado con éxito`,"success").then((function(e){location.reload()}))},onImageOne:async t=>{const n=t.target.files[0];if(!n)return e.value=null,void(a.value=null);{a.value=n.name;const t=new FileReader;t.onload=()=>e.value=t.result,t.readAsDataURL(n)}}}}},Y=t(89);const q=(0,Y.Z)(M,[["render",H],["__scopeId","data-v-7f151f08"]]);var K=q}}]);
//# sourceMappingURL=create-material.1b608285.js.map